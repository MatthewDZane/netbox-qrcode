{% extends 'base.html' %} 
{% load render_table from django_tables2 %} 
{% block content %}

<!--Multi Page Print Image Script-->
<script type="text/javascript">
  function printImg(source) {
    var win = window.open("")
    // Check if only one image selected
    //if(typeof source === 'string'){
    //  win.document.write('<img src="' + 'data:image/png;base64,' + source + '"/>')
    //}
    // Multiple images selected
    //else{
      // Add html template as new page to new window
      for(let i = 0; i < source.length - 1; i++){
        win.document.write('<div style="text-align: center"><img src="' + 'data:image/png;base64,' + source[i] + '"/></div><div style = "height:0; page-break-after: always"></div>')
      }
      // Add last image, print and close the new window
      win.document.write('<div style="text-align: center"><img style="text-align: center" src="' + 'data:image/png;base64,' + source[source.length-1] + '" onload="window.print();window.close()" /></div>')
    //}
    win.focus()
  }
</script>

<div>{{text}}</div>

<!--Top Panel-->
<div class="row">
  <div class="col-md-8 col-md-offset-2">
    <div class="panel panel-primary">
      <div class="panel-heading text-center panel-relative">
        <strong>Review Printed {{name}}</strong>
      </div>
    </div>

  </div>
</div>

<!--Table-->
<div class="row">
  <div class="col-md-8 col-md-offset-2">
    <div class="panel panel-default">{% include 'inc/table.html' %}</div>
  </div>
</div>
<div class="row">
  <div class="col-md-6 col-md-offset-3">
    <!--Print Button-->
    <div class="text-center">
      <button onclick="printImg({{image}})"; class="btn btn-xl btn-primary">
        <span class="glyphicon glyphicon-print" aria-hidden="true"></span>
        Print
      </button> 
    </div>
  </div>
</div>

<!--Preview Images-->
{% for img in image%}
<div class="row" style="padding-top: 100px">
  <div class="text-center">
    <h2>Page {{ forloop.counter }}</h2>
    <img src="data:image/png;base64,{{img}}" />
  </div>
</div>
{% endfor%}

{% endblock %}
